<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="style.css" type="text/css">
		<title>Monats Kalender</title>
		<script src="Kalender.js"> </script>
		<script type="text/javascript">
		var d = new Date();
		var m = d.getMonth() + 1;
		var y = d.getYear() + 1900;
		
		Monatsname = new Array("Januar", "Februar", "März", "April", "Mai", "Juni","Juli", "August", "September", "Oktober", "November", "Dezember");
		Wochentag = new Array("Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag");
		Gruppenmitglieder =new Array("Person 1","Person 2","Person 3","Person 4","Person 5","Person 6","Person 7");
		
		function background(id){
			if(document.getElementById(id).innerHTML=="Neptune"){
				document.getElementById('kalender').style.backgroundImage = "url('img/Neptune.png')";
			}
			else if(document.getElementById(id).innerHTML=="Star-Wars Clone"){
				document.getElementById('kalender').style.backgroundImage = "url('img/Star-Wars_Clone.jpg')";
			}
		}
		function MonatsKalender(Monat, Jahr) {
			var jetzt = new Date();		// aktuelles Datum
			var DieserMonat = jetzt.getMonth() + 1;
			var DiesesJahr = jetzt.getYear() + 1900;
			var DieserTag = jetzt.getDate();
			
			var Zeit = new Date(Jahr, Monat - 1, 1);
			var Start = Zeit.getDay();		//Wochentag des ersten Tags im Monat
			if (Start > 0) {
				Start--;
			} else {
				Start = 6;}
			//Stop
			var ende = 31;
			if (Monat == 4 || Monat == 6 || Monat == 9 || Monat == 11) --ende; // April(4), Juni(6), September(9), November(11) 30 Tage
			if (Monat == 2) {	//Februar(2)
				ende = ende - 3;
				if (Jahr % 4 == 0) ende++;		//Schaltjahren
				if (Jahr % 100 == 0) ende--;
				if (Jahr % 400 == 0) ende++;
			}
			
			var tabelle = document.getElementById('kalender');
			
			if(tabelle.rows.length >0){		//Tabellen inhalt löschen
				for(var i = 0; 0 != tabelle.rows.length; i++){
					tabelle.deleteRow(0);
				}
			}
			var Kopf = Monatsname[Monat-1] + " " + Jahr;	//Tabellenüberschrift
			var caption = tabelle.createCaption();
			caption.innerHTML = Kopf;
			
			var zeile = tabelle.insertRow(0);		//Tabellenkopf
			zeile.className = 'thead';
			var cell = zeile.insertCell(0);
			cell.innerHTML = "Datum";
			var cell = zeile.insertCell(1);
			cell.innerHTML = "Wochentag";
			for (var i = 0; i <= Gruppenmitglieder.length-1; i++) {
				var cell = zeile.insertCell(i+2);
				cell.innerHTML = Gruppenmitglieder[i];
			}
			var cell = zeile.insertCell(2+ Gruppenmitglieder.length);
			cell.innerHTML = "KW";
			
			var Tageszahl = 1;
			for (var i = 0; i < ende; i++) {		//Tabellenbody
				var zeile = tabelle.insertRow(i+1);
				
				zeile.className = 'kalendertag';	
				cells = zeile.insertCell(0);
				cells.innerHTML = Tageszahl;	//Datum
				
				cells = zeile.insertCell(1);
				var wt= Wochentag[(Start+Tageszahl-1)%7];		//Wochentag
				cells.innerHTML = wt;
				
				if (wt=="Samstag" || wt=="Sonntag") {
					zeile.className = zeile.className +' wochenende';
				}
				if ((Jahr == DiesesJahr) && (Monat == DieserMonat) && (Tageszahl == DieserTag)) {
					zeile.className = zeile.className + ' heute';
				}
				for (var j = 0; j <= Gruppenmitglieder.length -1; j++) {		//Zellen der Gruppenmitglieder
					cells = zeile.insertCell(j+2);
					cells.innerHTML = ' ';
				}
				if (wt=="Montag"||Tageszahl==1){							//Kalender Woche
					var date = new Date(y,m-1,Tageszahl);		//der Tag
					var currentThursday = new Date(date.getTime() +(3-((date.getDay()+6) % 7)) * 86400000);
					var yearOfThursday = currentThursday.getFullYear();
					var firstThursday = new Date(new Date(yearOfThursday,0,4).getTime() +(3-((new Date(yearOfThursday,0,4).getDay()+6) % 7)) * 86400000);
					
					cells = zeile.insertCell(Gruppenmitglieder.length +2);
					cells.className = 'kw';
					
					var kW = Math.floor(1 + 0.5 + (currentThursday.getTime() - firstThursday.getTime()) / 86400000/7);
					cells.innerHTML = kW;
					
					if(wt=="Montag"){		//!!!
						cells.colSpan =7;		//länge der Zelle 
					}
					else{
						//cells.colSpan=		7- Wochentag.position_von(wt);
					}
				}
				Tageszahl++;
			}
		}
		function Monat_wechsel(vor){
			if(vor){
				m = m+1;
				if(m==13){
					m =1;
					y =y+1;
				}
			}
			else{
				m = m-1;
				if(m==0){
					m =12;
					y =y-1;
				}
			}
			MonatsKalender(m, y);
		}
		</script>
	</head>
	<body>
		<div>
			<header class= header_hintergrund>
				<img src="img/schriftzug.png" alt="Logo" class="logo">
			</header>
			<nav>
				<section class=kasten>
					<header>
						<h1>Home</h1>
					</header>
					<hr>
					<div>							
						<a href="Eventübersicht.html">Alle Kalender</a><br>
						<a href="index.html">mein Kalender</a><br>
					</div>
				</section>
				<section class=kasten>
					<header>
						<h1>Ansicht</h1>
					</header>
					<hr>
					<div>
						<a href="WochenKalender.html">Wochen Ansicht</a><br>
						<a href="JahresKalender.html">Jahres Ansicht</a><br>
					</div>
				</section>
				<section class=kasten>
					<header>
						<h1>Kalender Hintergrund</h1>
					</header>
					<hr>
					<div>
						<a onclick="background('neptune')" id="neptune">Neptune</a><br>
						<a onclick="background('Star-Wars Clone')" id="Star-Wars Clone">Star-Wars Clone</a>
					</div>
				</section>
			</nav>
			<inhalt>
				<div class=pfeile>
					<div id=pfeil_zurueck>
						<a onclick="Monat_wechsel(false)" href="#">
							<img src="img/icon/left.png" title="letzte Monat">
							letzte Monat
						</a>
					</div>
					<div id=pfeil_vor>
						<a onclick="Monat_wechsel(true)" href="#">
							nächste Monat
							<img src="img/icon/right.png" title="nächste Monat">
						</a>
					</div>					
				</div>
				<div class=kasten>
					<table id=kalender align="center" >
						<colgroup>
							<col span="2" style="background-color: #00008b87;">
							<col span="7" style="background-color: #00118045;">
							<col style="background-color: #00008b87;">
						</colgroup>
					</table>
					<script type="text/javascript">
						MonatsKalender(m, j);
					</script>
				</div>
				<div class=pfeile>
					<div id=pfeil_zurueck>
						<a onclick="Monat_wechsel(false)" href="#">
							<img src="img/icon/left.png" title="letzte Monat">
							letzte Monat
						</a>
					</div>
					<div id=pfeil_vor>
						<a onclick="Monat_wechsel(true)" href="#">
							nächste Monat
							<img src="img/icon/right.png" title="nächste Monat">
						</a>
					</div>					
				</div>
				<br>
				<br>
			</inhalt>
		</div>
	</body>
</html>